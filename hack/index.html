<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Player System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: #0a1929;
            color: white;
            min-height: 100vh;
            padding: 10px;
        }
        
        .container {
            max-width: 1800px;
            margin: 0 auto;
        }
        
        /* VPN Warning */
        #vpnWarning {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            z-index: 2000;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
        }
        
        .vpn-box {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            padding: 40px;
            border-radius: 15px;
            border: 3px solid #ef4444;
            max-width: 600px;
            width: 90%;
        }
        
        .vpn-icon {
            font-size: 60px;
            color: #ef4444;
            margin-bottom: 20px;
        }
        
        .vpn-title {
            color: #ef4444;
            font-size: 28px;
            margin-bottom: 15px;
        }
        
        .vpn-text {
            color: #cbd5e1;
            margin-bottom: 25px;
            line-height: 1.6;
        }
        
        .vpn-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .vpn-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.3s;
        }
        
        .vpn-btn.connect {
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
        }
        
        .vpn-btn.ignore {
            background: rgba(239, 68, 68, 0.2);
            color: #ef4444;
            border: 1px solid #ef4444;
        }
        
        .vpn-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }
        
        /* Header */
        .header {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 15px;
            border: 1px solid #3b82f6;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .header-left h1 {
            font-size: 1.8rem;
            color: #60a5fa;
            margin-bottom: 5px;
        }
        
        .header-left p {
            color: #94a3b8;
            font-size: 14px;
        }
        
        .header-stats {
            display: flex;
            gap: 20px;
        }
        
        .stat {
            text-align: center;
        }
        
        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #60a5fa;
        }
        
        .stat-label {
            color: #94a3b8;
            font-size: 12px;
        }
        
        /* Main Layout */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 15px;
            margin-bottom: 80px;
        }
        
        @media (max-width: 1200px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
        }
        
        /* Video Section */
        .video-section {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #475569;
        }
        
        /* YouTube Input */
        .youtube-input {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #3b82f6;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        .input-label {
            color: #60a5fa;
            font-size: 14px;
            margin-bottom: 8px;
            display: block;
        }
        
        .input-field {
            width: 100%;
            padding: 10px;
            background: rgba(30, 41, 59, 0.8);
            border: 1px solid #475569;
            color: white;
            border-radius: 6px;
            font-size: 14px;
        }
        
        .input-field:focus {
            outline: none;
            border-color: #60a5fa;
        }
        
        /* Control Buttons */
        .control-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .control-btn {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
            border: 1px solid #3b82f6;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            display: flex;
            align-items: center;
            gap: 6px;
            transition: all 0.3s;
        }
        
        .control-btn:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        .control-btn.active {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
            color: white;
        }
        
        /* Video Grid */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }
        
        @media (max-width: 768px) {
            .video-grid {
                grid-template-columns: 1fr;
            }
        }
        
        .video-card {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #475569;
            transition: all 0.3s;
        }
        
        .video-card:hover {
            transform: translateY(-2px);
            border-color: #3b82f6;
        }
        
        .player-header {
            background: rgba(30, 41, 59, 0.9);
            padding: 10px 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .player-id {
            color: #60a5fa;
            font-weight: 600;
            font-size: 14px;
        }
        
        .player-email {
            color: #94a3b8;
            font-size: 12px;
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .video-container {
            width: 100%;
            height: 160px;
            background: #000;
        }
        
        .video-iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .player-controls {
            padding: 10px 15px;
            background: rgba(30, 41, 59, 0.9);
            display: flex;
            gap: 8px;
        }
        
        .player-btn {
            background: rgba(59, 130, 246, 0.1);
            color: #60a5fa;
            border: 1px solid #475569;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .player-btn:hover {
            background: rgba(59, 130, 246, 0.2);
        }
        
        /* Temp Mail Panel */
        .temp-mail-panel {
            background: rgba(30, 41, 59, 0.8);
            border-radius: 10px;
            padding: 15px;
            border: 1px solid #10b981;
            max-height: 800px;
            overflow-y: auto;
        }
        
        .panel-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid #475569;
        }
        
        .panel-title {
            color: #60a5fa;
            font-size: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .close-panel {
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            font-size: 20px;
            padding: 0;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Email Controls */
        .email-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .email-btn {
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 13px;
            flex: 1;
            min-width: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
        }
        
        .email-btn:hover {
            opacity: 0.9;
        }
        
        .email-btn.red {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }
        
        /* Email List */
        .email-list {
            background: rgba(15, 23, 42, 0.9);
            border-radius: 6px;
            padding: 10px;
            max-height: 400px;
            overflow-y: auto;
            margin-bottom: 15px;
        }
        
        .email-item {
            padding: 10px;
            margin-bottom: 8px;
            background: rgba(30, 41, 59, 0.6);
            border-radius: 4px;
            border-left: 3px solid #10b981;
        }
        
        .email-address {
            color: #60a5fa;
            font-family: 'Courier New', monospace;
            font-size: 12px;
            word-break: break-all;
        }
        
        .email-meta {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 11px;
            color: #94a3b8;
        }
        
        /* Bottom Controls */
        .bottom-controls {
            position: fixed;
            bottom: 10px;
            left: 10px;
            right: 10px;
            background: rgba(30, 41, 59, 0.95);
            padding: 12px;
            border-radius: 10px;
            border: 1px solid #3b82f6;
            display: flex;
            justify-content: center;
            gap: 15px;
            z-index: 100;
        }
        
        .bottom-btn {
            background: linear-gradient(45deg, #3b82f6, #2563eb);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            min-width: 140px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }
        
        .bottom-btn:hover {
            opacity: 0.9;
        }
        
        .bottom-btn.red {
            background: linear-gradient(45deg, #ef4444, #dc2626);
        }
        
        /* Toggle Button */
        .toggle-btn {
            position: fixed;
            top: 80px;
            right: 20px;
            background: linear-gradient(45deg, #10b981, #059669);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            z-index: 101;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }
        
        .toggle-btn:hover {
            transform: scale(1.1);
        }
        
        /* Status Bar */
        .status-bar {
            background: rgba(30, 41, 59, 0.8);
            padding: 10px;
            border-radius: 6px;
            margin: 15px 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 13px;
        }
        
        .progress-container {
            flex: 1;
            background: rgba(15, 23, 42, 0.9);
            height: 6px;
            border-radius: 3px;
            overflow: hidden;
            margin: 0 15px;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            width: 0%;
            transition: width 0.3s;
        }
        
        /* VPN Indicator */
        .vpn-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            display: flex;
            align-items: center;
            gap: 6px;
            border: 1px solid #10b981;
            z-index: 100;
        }
        
        /* Loading */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(30, 41, 59, 0.95);
            padding: 30px;
            border-radius: 10px;
            border: 1px solid #3b82f6;
            display: none;
            align-items: center;
            gap: 15px;
            z-index: 2000;
        }
        
        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #475569;
            border-top-color: #3b82f6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Responsive */
        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
            }
            
            .temp-mail-panel {
                position: fixed;
                top: 0;
                right: -100%;
                width: 100%;
                max-width: 400px;
                height: 100vh;
                z-index: 99;
                transition: right 0.3s;
            }
            
            .temp-mail-panel.active {
                right: 0;
            }
            
            .bottom-controls {
                flex-wrap: wrap;
            }
            
            .bottom-btn {
                min-width: 120px;
            }
        }
    </style>
</head>
<body>
    <!-- VPN Warning Screen -->
    <div id="vpnWarning" style="display: block;">
        <div class="vpn-box">
            <div class="vpn-icon">üîí</div>
            <h2 class="vpn-title">VPN REQUIRED</h2>
            <p class="vpn-text">
                This application requires a VPN connection to function properly.
                <br><br>
                All videos are <strong>MUTED BY DEFAULT</strong> to prevent audio conflicts and for privacy reasons.
                <br><br>
                Using a VPN helps protect your privacy and allows the system to work correctly.
            </p>
            
            <div class="vpn-buttons">
                <button class="vpn-btn connect" onclick="connectVPN()">
                    üîó Connect VPN
                </button>
                <button class="vpn-btn ignore" onclick="ignoreVPN()">
                    ‚ö†Ô∏è Continue Anyway
                </button>
            </div>
            
            <div style="margin-top: 25px; color: #94a3b8; font-size: 13px;">
                <div>Recommended VPN Services:</div>
                <div style="display: flex; justify-content: center; gap: 15px; margin-top: 10px; flex-wrap: wrap;">
                    <a href="https://www.expressvpn.com/" target="_blank" style="color: #3b82f6; text-decoration: none;">ExpressVPN</a>
                    <a href="https://nordvpn.com/" target="_blank" style="color: #3b82f6; text-decoration: none;">NordVPN</a>
                    <a href="https://surfshark.com/" target="_blank" style="color: #3b82f6; text-decoration: none;">Surfshark</a>
                    <a href="https://protonvpn.com/" target="_blank" style="color: #3b82f6; text-decoration: none;">ProtonVPN</a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-left">
                <h1>Multi-Player System</h1>
                <p>VPN Required | All Videos Muted by Default</p>
            </div>
            <div class="header-stats">
                <div class="stat">
                    <div class="stat-value" id="playerCount">0</div>
                    <div class="stat-label">Players</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="viewCount">0</div>
                    <div class="stat-label">Views</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="emailCount">0</div>
                    <div class="stat-label">Emails</div>
                </div>
            </div>
        </div>
        
        <!-- VPN Indicator -->
        <div class="vpn-indicator" id="vpnIndicator" style="display: none;">
            <span>üîí VPN Connected</span>
        </div>
        
        <!-- Main Layout -->
        <div class="main-layout">
            <!-- Video Section -->
            <div class="video-section">
                <!-- YouTube Input -->
                <div class="youtube-input">
                    <h3 style="color: #60a5fa; margin-bottom: 15px; font-size: 16px;">üé¨ YouTube Video URL</h3>
                    <div class="input-group">
                        <input type="text" 
                               id="youtubeLink" 
                               class="input-field" 
                               placeholder="Paste YouTube video link here..."
                               value="https://www.youtube.com/watch?v=dQw4w9WgXcQ">
                    </div>
                    
                    <div style="display: flex; gap: 10px;">
                        <input type="number" 
                               id="playerCountInput" 
                               class="input-field" 
                               placeholder="Players count"
                               value="5"
                               min="1"
                               max="50"
                               style="width: 120px;">
                        <button class="control-btn" onclick="loadVideo()" style="flex: 1;">
                            ‚ñ∂ Load Video
                        </button>
                    </div>
                </div>
                
                <!-- Control Buttons -->
                <div class="control-buttons">
                    <button class="control-btn" onclick="playAll()">
                        ‚ñ∂ Play All
                    </button>
                    <button class="control-btn" onclick="pauseAll()">
                        ‚è∏ Pause All
                    </button>
                    <button class="control-btn" onclick="startAutoPlay()">
                        üîÑ Auto Play
                    </button>
                    <button class="control-btn" onclick="cyclePlayers()">
                        üé° Cycle
                    </button>
                    <button class="control-btn" onclick="addPlayer()">
                        ‚ûï Add Player
                    </button>
                    <button class="control-btn" onclick="removePlayer()">
                        ‚ûñ Remove
                    </button>
                    <button class="control-btn" onclick="togglePanel()">
                        üìß Temp Mail
                    </button>
                </div>
                
                <!-- Status Bar -->
                <div class="status-bar">
                    <div style="color: #94a3b8;">Status:</div>
                    <div id="statusText" style="color: #60a5fa;">Ready</div>
                    <div class="progress-container">
                        <div class="progress-fill" id="progressFill"></div>
                    </div>
                    <div id="progressText" style="color: #94a3b8; min-width: 80px; text-align: right;">0 views</div>
                </div>
                
                <!-- Video Grid -->
                <div id="videoGrid" class="video-grid">
                    <!-- Video players will be added here -->
                </div>
            </div>
            
            <!-- Temp Mail Panel -->
            <div class="temp-mail-panel" id="tempMailPanel">
                <div class="panel-header">
                    <h3 class="panel-title">üìß Temp Mail System</h3>
                    <button class="close-panel" onclick="togglePanel()">√ó</button>
                </div>
                
                <!-- Email Controls -->
                <div class="email-controls">
                    <button class="email-btn" onclick="generateEmails()">
                        üìß Generate
                    </button>
                    <button class="email-btn" onclick="assignEmails()">
                        ü§ñ Assign
                    </button>
                    <button class="email-btn red" onclick="clearEmails()">
                        üóë Clear
                    </button>
                </div>
                
                <!-- Email Count -->
                <div style="margin-bottom: 15px;">
                    <input type="number" 
                           id="emailCountInput" 
                           class="input-field" 
                           placeholder="Number of emails"
                           value="10"
                           min="1"
                           max="100">
                </div>
                
                <!-- API Key -->
                <div style="margin-bottom: 15px;">
                    <div class="input-label">Temp Mail API Key:</div>
                    <input type="text" 
                           id="apiKeyInput" 
                           class="input-field" 
                           placeholder="Enter API key"
                           value="sk_yoh0ClLFsbKeCkl4_umA8khJrFeXE0oJKp9i3UrwqtU9Jo0St5pnFGL8TIGBjhM9lsgWT9n0zRrCVBxGr">
                </div>
                
                <!-- Email List -->
                <div class="email-list" id="emailList">
                    <div class="email-item">
                        <div class="email-address">No emails generated yet</div>
                        <div class="email-meta">
                            <span>Click Generate</span>
                        </div>
                    </div>
                </div>
                
                <!-- Email Stats -->
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <div style="background: rgba(15, 23, 42, 0.9); padding: 10px; border-radius: 6px; text-align: center;">
                        <div style="color: #60a5fa; font-size: 16px; font-weight: bold;" id="totalEmails">0</div>
                        <div style="color: #94a3b8; font-size: 12px;">Total Emails</div>
                    </div>
                    <div style="background: rgba(15, 23, 42, 0.9); padding: 10px; border-radius: 6px; text-align: center;">
                        <div style="color: #10b981; font-size: 16px; font-weight: bold;" id="assignedEmails">0</div>
                        <div style="color: #94a3b8; font-size: 12px;">Assigned</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Bottom Controls -->
        <div class="bottom-controls">
            <button class="bottom-btn" onclick="loadDefault()">
                üöÄ Quick Start
            </button>
            <button class="bottom-btn" onclick="startAutoPlay()">
                üîÑ Auto Mode
            </button>
            <button class="bottom-btn" onclick="stopAll()">
                ‚èπ Stop All
            </button>
            <button class="bottom-btn red" onclick="resetSystem()">
                üîÑ Reset
            </button>
        </div>
        
        <!-- Toggle Button -->
        <button class="toggle-btn" onclick="togglePanel()" id="toggleBtn">üìß</button>
    </div>
    
    <!-- Loading Overlay -->
    <div class="loading" id="loading">
        <div class="spinner"></div>
        <div>Loading...</div>
    </div>

    <script>
        // Global variables
        let players = [];
        let tempEmails = [];
        let viewCount = 0;
        let currentVideoId = "";
        let isAutoPlaying = false;
        let isCycling = false;
        let autoPlayInterval;
        let cycleInterval;
        let vpnConnected = false;
        const API_KEY = "sk_yoh0ClLFsbKeCkl4_umA8khJrFeXE0oJKp9i3UrwqtU9Jo0St5pnFGL8TIGBjhM9lsgWT9n0zRrCVBxGr";
        
        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            console.log("Multi-Player System Initialized");
            console.log("All videos are muted by default");
            
            // Check if VPN is already connected (simulated)
            checkVPN();
            
            // Generate initial emails
            generateEmails(5);
        });
        
        // VPN Functions
        function connectVPN() {
            showLoading("Connecting to VPN...");
            
            setTimeout(() => {
                vpnConnected = true;
                document.getElementById('vpnWarning').style.display = 'none';
                document.getElementById('vpnIndicator').style.display = 'flex';
                hideLoading();
                showStatus("VPN Connected Successfully");
                
                // Auto-load default video
                setTimeout(() => {
                    loadDefault();
                }, 1000);
            }, 2000);
        }
        
        function ignoreVPN() {
            vpnConnected = true;
            document.getElementById('vpnWarning').style.display = 'none';
            document.getElementById('vpnIndicator').style.display = 'flex';
            document.getElementById('vpnIndicator').innerHTML = '<span>‚ö†Ô∏è VPN Not Connected</span>';
            showStatus("Warning: VPN not connected");
            
            // Auto-load default video
            setTimeout(() => {
                loadDefault();
            }, 1000);
        }
        
        function checkVPN() {
            // Simulated VPN check
            // In real implementation, you would check IP location, latency, etc.
            const hasVPN = Math.random() > 0.5; // 50% chance
            if (hasVPN) {
                vpnConnected = true;
                document.getElementById('vpnWarning').style.display = 'none';
                document.getElementById('vpnIndicator').style.display = 'flex';
                showStatus("VPN detected");
            }
        }
        
        // Show loading
        function showLoading(text = "Loading...") {
            const loading = document.getElementById('loading');
            loading.children[1].textContent = text;
            loading.style.display = 'flex';
        }
        
        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
        }
        
        // Show status
        function showStatus(message) {
            document.getElementById('statusText').textContent = message;
            
            // Create temporary status message
            const statusDiv = document.createElement('div');
            statusDiv.style.cssText = `
                position: fixed;
                top: 60px;
                right: 20px;
                background: rgba(30, 41, 59, 0.95);
                color: white;
                padding: 10px 15px;
                border-radius: 6px;
                border: 1px solid #3b82f6;
                font-size: 13px;
                z-index: 1000;
            `;
            statusDiv.textContent = message;
            document.body.appendChild(statusDiv);
            
            setTimeout(() => {
                statusDiv.remove();
            }, 3000);
        }
        
        // Toggle panel
        function togglePanel() {
            const panel = document.getElementById('tempMailPanel');
            const btn = document.getElementById('toggleBtn');
            
            if (window.innerWidth <= 768) {
                panel.classList.toggle('active');
                btn.textContent = panel.classList.contains('active') ? '√ó' : 'üìß';
            } else {
                panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
                btn.style.display = 'flex';
            }
        }
        
        // Update stats
        function updateStats() {
            document.getElementById('playerCount').textContent = players.length;
            document.getElementById('viewCount').textContent = viewCount;
            document.getElementById('emailCount').textContent = tempEmails.length;
            document.getElementById('totalEmails').textContent = tempEmails.length;
            document.getElementById('assignedEmails').textContent = tempEmails.filter(e => e.assigned).length;
            document.getElementById('progressText').textContent = `${viewCount} views`;
        }
        
        // Extract video ID
        function extractVideoId(url) {
            if (!url) return null;
            
            const patterns = [
                /(?:youtube\.com\/watch\?v=)([^&]+)/,
                /(?:youtu\.be\/)([^?]+)/,
                /(?:youtube\.com\/embed\/)([^?]+)/
            ];
            
            for (let pattern of patterns) {
                const match = url.match(pattern);
                if (match && match[1]) {
                    return match[1].split('&')[0].split('?')[0];
                }
            }
            return null;
        }
        
        // Load video
        function loadVideo() {
            if (!vpnConnected) {
                document.getElementById('vpnWarning').style.display = 'flex';
                showStatus("VPN required to continue");
                return;
            }
            
            const linkInput = document.getElementById('youtubeLink');
            const countInput = document.getElementById('playerCountInput');
            
            const url = linkInput.value.trim();
            const count = parseInt(countInput.value) || 5;
            
            if (!url) {
                showStatus("Please enter YouTube URL");
                return;
            }
            
            const videoId = extractVideoId(url);
            if (!videoId) {
                showStatus("Invalid YouTube URL");
                return;
            }
            
            showLoading("Loading video players...");
            currentVideoId = videoId;
            
            // Clear existing players
            clearPlayers();
            
            // Create players
            setTimeout(() => {
                for (let i = 0; i < count; i++) {
                    createPlayer(videoId, i);
                }
                
                updateStats();
                hideLoading();
                showStatus(`Loaded ${count} players (All Muted)`);
                
                // Auto-assign emails
                setTimeout(assignEmails, 500);
            }, 1000);
        }
        
        // Load default
        function loadDefault() {
            document.getElementById('youtubeLink').value = 'https://www.youtube.com/watch?v=dQw4w9WgXcQ';
            loadVideo();
        }
        
        // Create player
        function createPlayer(videoId, index) {
            const grid = document.getElementById('videoGrid');
            
            const card = document.createElement('div');
            card.className = 'video-card';
            card.id = `player-${index}`;
            
            // Get email
            let email = 'No email';
            let emailId = null;
            
            const availableEmail = tempEmails.find(e => !e.assigned);
            if (availableEmail) {
                email = availableEmail.address;
                emailId = availableEmail.id;
                availableEmail.assigned = true;
                availableEmail.assignedTo = index;
            }
            
            card.innerHTML = `
                <div class="player-header">
                    <div class="player-id">Player ${index + 1}</div>
                    <div class="player-email" title="${email}">${email}</div>
                </div>
                <div class="video-container">
                    <iframe class="video-iframe"
                            src="https://www.youtube.com/embed/${videoId}?enablejsapi=1&autoplay=0&mute=1&rel=0&controls=0&showinfo=0"
                            allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen
                            frameborder="0">
                    </iframe>
                </div>
                <div class="player-controls">
                    <button onclick="playSingle(${index})" class="player-btn">‚ñ∂ Play</button>
                    <button onclick="pauseSingle(${index})" class="player-btn">‚è∏ Pause</button>
                    <button onclick="restartSingle(${index})" class="player-btn">‚Ü∫ Restart</button>
                    <div style="color: #94a3b8; font-size: 11px; margin-left: auto;">
                        Views: <span id="views-${index}">0</span>
                    </div>
                </div>
            `;
            
            grid.appendChild(card);
            
            players[index] = {
                element: card,
                iframe: card.querySelector('iframe'),
                index: index,
                videoId: videoId,
                email: email,
                emailId: emailId,
                views: 0,
                active: false
            };
            
            updateEmailList();
        }
        
        // Clear players
        function clearPlayers() {
            players = [];
            const grid = document.getElementById('videoGrid');
            grid.innerHTML = '';
            viewCount = 0;
            updateStats();
            stopAll();
        }
        
        // Play single
        window.playSingle = function(index) {
            const player = players[index];
            if (!player) return;
            
            const iframe = player.iframe;
            if (iframe.contentWindow) {
                try {
                    iframe.contentWindow.postMessage(JSON.stringify({
                        event: 'command',
                        func: 'playVideo',
                        args: ''
                    }), '*');
                    
                    player.active = true;
                    player.views++;
                    viewCount++;
                    
                    document.getElementById(`views-${index}`).textContent = player.views;
                    
                    // Update email views
                    if (player.emailId) {
                        const email = tempEmails.find(e => e.id === player.emailId);
                        if (email) email.views = (email.views || 0) + 1;
                    }
                    
                    updateStats();
                    updateProgress();
                } catch (error) {
                    console.error('Play error:', error);
                }
            }
        };
        
        // Pause single
        window.pauseSingle = function(index) {
            const player = players[index];
            if (!player) return;
            
            const iframe = player.iframe;
            if (iframe.contentWindow) {
                iframe.contentWindow.postMessage(JSON.stringify({
                    event: 'command',
                    func: 'pauseVideo',
                    args: ''
                }), '*');
                
                player.active = false;
                updateStats();
            }
        };
        
        // Restart single
        window.restartSingle = function(index) {
            const player = players[index];
            if (!player) return;
            
            const iframe = player.iframe;
            if (iframe.contentWindow) {
                iframe.contentWindow.postMessage(JSON.stringify({
                    event: 'command',
                    func: 'seekTo',
                    args: [0, true]
                }), '*');
                
                setTimeout(() => {
                    playSingle(index);
                }, 100);
            }
        };
        
        // Play all
        function playAll() {
            if (players.length === 0) {
                showStatus("No players loaded");
                return;
            }
            
            players.forEach((_, index) => {
                playSingle(index);
            });
            
            showStatus(`Playing all ${players.length} players`);
        }
        
        // Pause all
        function pauseAll() {
            if (players.length === 0) {
                showStatus("No players loaded");
                return;
            }
            
            players.forEach((_, index) => {
                pauseSingle(index);
            });
            
            showStatus("Paused all players");
        }
        
        // Start auto play
        function startAutoPlay() {
            if (isAutoPlaying) {
                stopAutoPlay();
                return;
            }
            
            if (players.length === 0) {
                showStatus("Load players first");
                return;
            }
            
            isAutoPlaying = true;
            showStatus("Auto play started");
            
            autoPlayInterval = setInterval(() => {
                const count = Math.floor(Math.random() * players.length / 2) + 1;
                for (let i = 0; i < count; i++) {
                    const index = Math.floor(Math.random() * players.length);
                    playSingle(index);
                }
                
                updateProgress();
            }, 2000);
        }
        
        // Stop auto play
        function stopAutoPlay() {
            isAutoPlaying = false;
            clearInterval(autoPlayInterval);
            showStatus("Auto play stopped");
        }
        
        // Cycle players
        function cyclePlayers() {
            if (isCycling) {
                stopCycle();
                return;
            }
            
            if (players.length === 0) {
                showStatus("Load players first");
                return;
            }
            
            isCycling = true;
            let current = 0;
            showStatus("Cycle mode started");
            
            cycleInterval = setInterval(() => {
                pauseAll();
                
                setTimeout(() => {
                    playSingle(current);
                    current = (current + 1) % players.length;
                }, 500);
                
            }, 3000);
        }
        
        // Stop cycle
        function stopCycle() {
            isCycling = false;
            clearInterval(cycleInterval);
            showStatus("Cycle mode stopped");
        }
        
        // Add player
        function addPlayer() {
            if (!currentVideoId) {
                showStatus("Load a video first");
                return;
            }
            
            const index = players.length;
            createPlayer(currentVideoId, index);
            updateStats();
            showStatus(`Added player ${index + 1}`);
        }
        
        // Remove player
        function removePlayer() {
            if (players.length === 0) {
                showStatus("No players to remove");
                return;
            }
            
            const index = players.length - 1;
            const player = players.pop();
            
            if (player.emailId) {
                const email = tempEmails.find(e => e.id === player.emailId);
                if (email) {
                    email.assigned = false;
                    email.assignedTo = null;
                }
            }
            
            document.getElementById(`player-${index}`).remove();
            updateStats();
            updateEmailList();
            showStatus(`Removed player ${index + 1}`);
        }
        
        // Stop all
        function stopAll() {
            stopAutoPlay();
            stopCycle();
            pauseAll();
            document.getElementById('progressFill').style.width = '0%';
            showStatus("All activities stopped");
        }
        
        // Reset system
        function resetSystem() {
            players = [];
            tempEmails = [];
            viewCount = 0;
            
            document.getElementById('videoGrid').innerHTML = '';
            document.getElementById('emailList').innerHTML = `
                <div class="email-item">
                    <div class="email-address">No emails generated yet</div>
                    <div class="email-meta">
                        <span>Click Generate</span>
                    </div>
                </div>
            `;
            
            updateStats();
            stopAll();
            showStatus("System reset");
        }
        
        // Update progress
        function updateProgress() {
            const progress = Math.min(100, Math.floor(viewCount / 2));
            document.getElementById('progressFill').style.width = `${progress}%`;
        }
        
        // Generate emails
        function generateEmails(count = null) {
            if (!count) {
                count = parseInt(document.getElementById('emailCountInput').value) || 10;
            }
            
            const domains = [
                'tempmail.com', '10minutemail.net', 'mailinator.com',
                'guerrillamail.com', 'yopmail.com', 'trashmail.com'
            ];
            
            const prefixes = ['bot', 'user', 'viewer', 'player', 'watch', 'video'];
            
            for (let i = 0; i < count; i++) {
                const prefix = prefixes[Math.floor(Math.random() * prefixes.length)];
                const domain = domains[Math.floor(Math.random() * domains.length)];
                const numbers = Math.floor(Math.random() * 99999).toString().padStart(5, '0');
                const email = `${prefix}${numbers}@${domain}`;
                
                tempEmails.push({
                    id: Date.now() + i,
                    address: email,
                    assigned: false,
                    assignedTo: null,
                    views: 0
                });
            }
            
            updateEmailList();
            updateStats();
            showStatus(`Generated ${count} temp emails`);
        }
        
        // Clear emails
        function clearEmails() {
            tempEmails = [];
            updateEmailList();
            updateStats();
            showStatus("Cleared all emails");
        }
        
        // Assign emails
        function assignEmails() {
            if (players.length === 0) {
                showStatus("Load players first");
                return;
            }
            
            let assigned = 0;
            const availableEmails = tempEmails.filter(e => !e.assigned);
            
            if (availableEmails.length === 0) {
                showStatus("No available emails");
                return;
            }
            
            players.forEach((player, index) => {
                if (availableEmails.length > 0 && !player.emailId) {
                    const email = availableEmails.shift();
                    email.assigned = true;
                    email.assignedTo = index;
                    
                    player.email = email.address;
                    player.emailId = email.id;
                    
                    const playerCard = document.getElementById(`player-${index}`);
                    if (playerCard) {
                        const emailElement = playerCard.querySelector('.player-email');
                        if (emailElement) {
                            emailElement.textContent = email.address;
                            emailElement.title = email.address;
                        }
                    }
                    
                    assigned++;
                }
            });
            
            updateEmailList();
            updateStats();
            showStatus(`Assigned ${assigned} emails to players`);
        }
        
        // Update email list
        function updateEmailList() {
            const container = document.getElementById('emailList');
            if (!container) return;
            
            container.innerHTML = '';
            
            if (tempEmails.length === 0) {
                container.innerHTML = `
                    <div class="email-item">
                        <div class="email-address">No emails generated</div>
                        <div class="email-meta">
                            <span>Click Generate</span>
                        </div>
                    </div>
                `;
                return;
            }
            
            tempEmails.forEach((email) => {
                const item = document.createElement('div');
                item.className = 'email-item';
                item.innerHTML = `
                    <div class="email-address">${email.address}</div>
                    <div class="email-meta">
                        <span>${email.assigned ? `Player ${email.assignedTo + 1}` : 'Available'}</span>
                        <span>Views: ${email.views || 0}</span>
                    </div>
                `;
                container.appendChild(item);
            });
        }
        
        // Initialize
        setTimeout(() => {
            if (!vpnConnected) {
                document.getElementById('vpnWarning').style.display = 'flex';
            }
        }, 1000);
    </script>
</body>
</html>
